"""
MIGRACIÓN PARTE 3 — Amatista MySQL → ERP PostgreSQL
Tablas: ventas, pedidos, detalle_ventas
REQUIERE: haber ejecutado partes 1 y 2 primero.
Ejecutar: python migrate_03_ventas_pedidos_detalles.py
"""

import psycopg2
import uuid
import random
import string
from datetime import datetime, timezone

DB_CONFIG = {
    "dbname": "Amatista_dev",
    "user": "root",
    "password": "123456789",
    "host": "localhost",
    "port": 5432,
}

# ─── DATOS COMPLETOS DEL DUMP MySQL ───────────────────────────────────────────
# reporte_entregas completo
REPORTE_ENTREGAS = [
    # (id, nombre_cliente, telefono_cliente, fecha_compra, fecha_entrega, turno_entrega,
    #  observacion, nombre_destinatario, telefono_destinatario, distrito,
    #  direccion_destinatario, enlace_ubicacion, tipo_ubicacion, dedicatoria,
    #  costo_delivery, metodo_pago, estado, estado_produccion, es_urgente,
    #  produccion_iniciada_en, produccion_completada_en,
    #  created_by, conductor_id,
    #  foto_entrega, observacion_conductor, fecha_confirmacion, estado_anterior,
    #  created_at, updated_at)
    (
        3,
        "WG",
        "958690844",
        "2026-01-28",
        "2026-02-13",
        "manana",
        None,
        "madeleine",
        "943168982",
        "san_isidro",
        "A.V Republica de panama, san isidro",
        None,
        "oficina",
        None,
        15.00,
        "plin",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        2,
        1,
        None,
        None,
        None,
        None,
        "2026-02-09 15:58:03",
        "2026-02-13 16:54:41",
    ),
    (
        4,
        "nelson tasayco",
        "944269091",
        "2026-02-06",
        "2026-02-12",
        "tarde",
        None,
        "angela liset celestino",
        "956352998",
        "breña",
        "pasaje nacario 162. Dptosol",
        None,
        "casa",
        None,
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        2,
        2,
        None,
        None,
        None,
        None,
        "2026-02-09 16:02:39",
        "2026-02-12 22:17:40",
    ),
    (
        5,
        "gary",
        "994707723",
        "2026-02-03",
        "2026-02-14",
        "manana",
        None,
        "faviana cabral",
        "989012915",
        "miraflores",
        "calle aristedes aljovin 686",
        None,
        "casa",
        None,
        15.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-13 21:59:04",
        "2026-02-13 21:59:08",
        2,
        7,
        None,
        "Ok",
        "2026-02-14 15:21:46",
        "en_ruta",
        "2026-02-09 16:09:45",
        "2026-02-14 15:21:46",
    ),
    (
        6,
        "Juantxo Guibelalde",
        "949699075",
        "2026-02-09",
        "2026-02-14",
        "manana",
        None,
        "Encar Torre  966 405 311",
        "966405311",
        "san_isidro",
        "calle cura bejar 105 dpt. 401",
        None,
        "casa",
        "*****adicional lleva 17 rosas rojas individuales)",
        15.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 03:02:02",
        "2026-02-14 04:15:30",
        1,
        7,
        None,
        "No me dieron",
        "2026-02-14 15:08:27",
        "en_ruta",
        "2026-02-09 19:07:18",
        "2026-02-16 13:23:52",
    ),
    (
        7,
        "Marcelo Zamora",
        "994747887",
        "2026-02-09",
        "2026-02-14",
        "manana",
        None,
        "Sara Amelia",
        "915055910",
        "pueblo_libre",
        "Angela Podesta 133",
        None,
        "casa",
        'ramo de rosas con colores pasteles\n"Para mi amada..."',
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:25",
        "2026-02-14 07:50:20",
        1,
        8,
        None,
        "A la mamá",
        "2026-02-14 18:47:52",
        "reprogramado",
        "2026-02-09 22:19:06",
        "2026-02-14 18:47:52",
    ),
    (
        8,
        "Rafa",
        "929282696",
        "2026-02-09",
        "2026-02-13",
        "manana",
        None,
        "Jimena Bardale",
        "929282696",
        "san_borja",
        "avenida de la opesis 155",
        None,
        "oficina",
        "La miré con tal persistencia...",
        15.00,
        "yape",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-09 23:43:06",
        "2026-02-13 16:54:34",
    ),
    (
        9,
        "Ricardo Aguilar",
        "946583545",
        "2026-02-10",
        "2026-02-14",
        "manana",
        None,
        "Rommy Pino Ramos",
        "997371386",
        "la_victoria",
        "avenida Las Americas 1509",
        None,
        "casa",
        "Para mí Chinita\nel Amor \nDe mi Vida",
        20.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-13 22:00:51",
        "2026-02-13 22:01:28",
        1,
        1,
        None,
        "Ningúna",
        "2026-02-14 13:54:32",
        "en_ruta",
        "2026-02-10 19:35:13",
        "2026-02-14 13:54:32",
    ),
    (
        10,
        "gerar",
        "913801174",
        "2026-02-10",
        "2026-02-14",
        "manana",
        None,
        "Mari Risco Segovia",
        "922367541",
        "san_juan_lurigancho",
        "mercado San Martin de porras puesto 45",
        None,
        "oficina",
        "TE AMO MI AMOR",
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:22",
        "2026-02-14 07:50:23",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-10 20:15:05",
        "2026-02-16 13:23:42",
    ),
    (
        11,
        "ramon deheza",
        "998178066",
        "2026-02-11",
        "2026-02-13",
        "tarde",
        None,
        "lorena leon",
        "998178066",
        "san_isidro",
        "los castaños 351 dpto. 302",
        None,
        "casa",
        "Ramón, Joaquin y valentina",
        0.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:06:26",
        "2026-02-13 20:17:42",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-11 17:51:56",
        "2026-02-14 03:01:42",
    ),
    (
        12,
        "rodrigo lara",
        "953844607",
        "2026-02-11",
        "2026-02-13",
        "manana",
        None,
        "josselyn peña",
        "961549783",
        "la_molina",
        "avenida la molina 190 (oficina atento)",
        None,
        "oficina",
        "Mi bobita, se que no estamos en nuestros mejores momentos...",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-11 18:10:43",
        "2026-02-13 16:56:33",
    ),
    (
        13,
        "luis morales",
        "(+1) 8313321425",
        "2026-02-11",
        "2026-02-14",
        "manana",
        None,
        "Mariel Jeri",
        "980761391",
        "san_borja",
        "pablo usandizaga 670",
        None,
        "casa",
        "Con todo mi AMOR  Chanchita",
        32.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-13 21:59:31",
        "2026-02-13 21:59:37",
        1,
        10,
        None,
        ".",
        "2026-02-14 20:06:01",
        "en_ruta",
        "2026-02-11 18:32:56",
        "2026-02-14 20:06:01",
    ),
    (
        14,
        "marcela  ruiz gonzales",
        "987768037",
        "2026-02-11",
        "2026-02-13",
        "manana",
        None,
        "marcela ruiz gonzales",
        "98778037",
        "lima",
        "Jr. carabaya 341",
        None,
        "oficina",
        None,
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        2,
        1,
        None,
        None,
        None,
        None,
        "2026-02-11 20:56:21",
        "2026-02-13 16:54:23",
    ),
    (
        15,
        "wilson",
        "929625071",
        "2026-02-11",
        "2026-02-13",
        "manana",
        None,
        "Ingrid Nevado",
        "934957595",
        "independencia",
        "Avenida Carlos Izaguirre 176 Ministerio Publico",
        None,
        "oficina",
        "carita",
        30.00,
        "bcp",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-11 23:43:58",
        "2026-02-13 16:56:40",
    ),
    (
        16,
        "sin nombre",
        "906946932",
        "2026-02-11",
        "2026-02-14",
        "manana",
        None,
        "wendy Berrios",
        "996642560",
        "magdalena",
        "Juan de Aliga 456",
        None,
        "casa",
        "En la vida siempre es importante esa persona...",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:09:49",
        "2026-02-14 02:09:56",
        1,
        7,
        None,
        "Ok se espero 10 minutos",
        "2026-02-14 14:46:58",
        "en_ruta",
        "2026-02-11 23:54:00",
        "2026-02-14 14:46:58",
    ),
    (
        17,
        "Wilmer Matos",
        "953844397",
        "2026-02-11",
        "2026-02-14",
        "manana",
        None,
        "Nelly Robles",
        "953844397",
        "santiago_surco",
        "Calle Majes 127",
        None,
        "casa",
        None,
        18.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-13 22:00:02",
        "2026-02-13 22:00:05",
        1,
        10,
        None,
        ".",
        "2026-02-14 16:59:56",
        "en_ruta",
        "2026-02-12 00:49:30",
        "2026-02-14 16:59:56",
    ),
    (
        18,
        "jhon mejias",
        "941958045",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Maria Gracia Garcia",
        "996138907",
        "jesus_maria",
        "Jiron Costa Rica 140",
        None,
        "casa",
        "Este 14 de febrero no solo celebro nuestro amor...",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:16",
        "2026-02-14 07:50:15",
        1,
        8,
        None,
        "Conserje",
        "2026-02-14 15:18:26",
        "en_ruta",
        "2026-02-12 15:59:46",
        "2026-02-14 15:18:26",
    ),
    (
        19,
        "roberto blados",
        "+51 940 233 983",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "vanesa rios",
        "940233983",
        "pueblo_libre",
        "av del rio 291  dpt 802",
        None,
        "casa",
        "Feliz día de San Valentín mi amorcito, te amo",
        20.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:10:14",
        "2026-02-14 02:10:17",
        2,
        8,
        None,
        "Esposo",
        "2026-02-14 13:12:12",
        "en_ruta",
        "2026-02-12 17:25:01",
        "2026-02-14 13:12:12",
    ),
    (
        20,
        "Ernesto Jaimes",
        "993453058",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Mariella Feria",
        "993453058",
        "santiago_surco",
        "Jiron Aguada Blanca 119 Dpto. 201",
        None,
        "casa",
        "Hola Jamoncita, mi Jamoncita!!",
        18.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-13 22:00:30",
        "2026-02-13 22:00:35",
        1,
        10,
        None,
        ".",
        "2026-02-14 20:05:57",
        "en_ruta",
        "2026-02-12 20:19:59",
        "2026-02-14 20:05:57",
    ),
    (
        21,
        "Jorge Hoyos",
        "978725040",
        "2026-02-12",
        "2026-02-12",
        "tarde",
        None,
        "Jorge Hoyos",
        "978725040",
        "surquillo",
        "Calle Victor Matilla 544",
        None,
        "oficina",
        "Gracias por todo lo que haces por mí...",
        0.00,
        "yape",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-12 20:24:29",
        "2026-02-16 13:23:35",
    ),
    (
        22,
        "Darwib",
        "989271457",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Yesica Cruz   Cecilia Zelaya",
        "989271457",
        "comas",
        "Jiron San Gregorio 617",
        None,
        "casa",
        "Tulipanes \nPara mi amada esposa...",
        30.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:06:17",
        "2026-02-14 02:06:26",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-12 21:17:36",
        "2026-02-16 13:23:12",
    ),
    (
        23,
        "klein",
        "+51 943 550 891",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "ana martel",
        "943550891",
        "miraflores",
        "av federico villareal 454 miraflores",
        None,
        "casa",
        "Feliz día del amor mi Reina...",
        12.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 21:58:42",
        "2026-02-13 21:58:45",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 15:08:39",
        "en_ruta",
        "2026-02-12 22:10:06",
        "2026-02-14 15:08:39",
    ),
    (
        25,
        "Bruno Francisco",
        "946540193",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Fiorella Araceli Yauramiza",
        "987181792",
        "ate",
        "Calle Bilbao Mz.S1, Lote 21 Dpto 501",
        "https://www.google.com/maps/place/12%C2%B003'38.8%22S+76%C2%B056'27.7%22W/@-12.0607681,-76.9436073,17z",
        "casa",
        "Fiorella,\nNo siempre somos perfectos...",
        30.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-13 22:02:35",
        "2026-02-13 22:02:40",
        1,
        9,
        None,
        "Se tocó varias veces su puerta...",
        "2026-02-14 17:40:17",
        "en_ruta",
        "2026-02-13 00:34:24",
        "2026-02-16 13:23:28",
    ),
    (
        26,
        "alain",
        "997893193",
        "2026-02-05",
        "2026-02-13",
        "tarde",
        None,
        "frizzia villena bernal",
        "941366464",
        "san_borja",
        "calle 10 414 monterrico norte",
        None,
        "casa",
        "Es nuestro 15vo día de los enamorados..!!",
        18.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:11:38",
        "2026-02-13 20:17:53",
        1,
        6,
        None,
        None,
        None,
        None,
        "2026-02-13 00:47:22",
        "2026-02-13 20:48:03",
    ),
    (
        27,
        "Carlos Paredes",
        "993136116",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Rebeca Calderon",
        "989484733",
        "rimac",
        "Totorita Mz E, lt. 1",
        "https://www.google.com/maps/place/Gral.+Vidal+%26+Av.+Francisco+Pizarro,+R%C3%ADmac+15094",
        "casa",
        None,
        25.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:47:44",
        "2026-02-14 09:48:22",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-13 01:31:01",
        "2026-02-16 13:23:07",
    ),
    (
        28,
        "Erick Chinchayau",
        "949559787",
        "2026-02-12",
        "2026-02-13",
        "manana",
        None,
        "Iris Diaz",
        "921634317",
        "san_isidro",
        "Avenida Arequipa 2637",
        None,
        "oficina",
        "Detrás de tu forma reservada hay algo que me encanta descubrir.",
        18.00,
        "payum",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:00:32",
        "2026-02-13 20:00:38",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 01:47:58",
        "2026-02-13 20:47:45",
    ),
    (
        29,
        "cristian",
        "996890207",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "rocio tarazona",
        "999348200",
        "breña",
        "calle mariano",
        None,
        "casa",
        "Feliz día de San Valentín  \nMi Chío !!!",
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:29",
        "2026-02-14 07:50:28",
        1,
        8,
        None,
        "Falta dirección y no contesta el celular4",
        "2026-02-14 18:30:06",
        "reprogramado",
        "2026-02-13 02:32:43",
        "2026-02-14 18:30:06",
    ),
    (
        30,
        "Rogger",
        "991128850",
        "2026-02-12",
        "2026-02-13",
        "manana",
        None,
        "Camila Ramirez",
        "967791133",
        "lima",
        "Jiron Camana 1043 edificio recoleta",
        None,
        "oficina",
        "Cuando alguien te mueve el corazón...",
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-13 03:32:05",
        "2026-02-13 16:54:29",
    ),
    (
        32,
        "piero paz",
        "992495184",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "andrea perez",
        "937381891",
        "santiago_surco",
        "galicia 142 surco higuereta",
        None,
        "casa",
        '"Espero que alegren tu dia..."',
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:33",
        "2026-02-14 07:50:30",
        2,
        10,
        None,
        ".",
        "2026-02-14 16:54:29",
        "en_ruta",
        "2026-02-13 14:04:13",
        "2026-02-14 16:54:29",
    ),
    (
        33,
        "miguel",
        "991117104",
        "2026-02-13",
        "2026-02-13",
        "tarde",
        None,
        "miguel ruiz mezones",
        "991117104",
        "san_borja",
        "jr juan de velde 142",
        None,
        "casa",
        "Que pases un feliz dia",
        18.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:17:15",
        "2026-02-13 20:39:04",
        4,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 15:25:28",
        "2026-02-14 02:58:24",
    ),
    (
        34,
        "arom",
        "+51 998 809 922",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "maria echegoyen sotomayor",
        "947485268",
        "la_molina",
        "carril derecho de la Avenida la Molina Este 178,",
        "https://maps.app.goo.gl/MJWdc7BCrvYMmezd6",
        "casa",
        '"Entre tanta gente y tantos días..."',
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:47:47",
        "2026-02-14 09:48:24",
        4,
        9,
        None,
        "Entrega a la misma señorita",
        "2026-02-14 17:38:19",
        "en_ruta",
        "2026-02-13 15:29:13",
        "2026-02-14 17:38:19",
    ),
    (
        35,
        "Pame",
        "992898130",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "Sherlie Tello",
        "966420765",
        "lima",
        "jiron Puno 914, edificio Yang piso 4",
        None,
        "oficina",
        "Feliz Día de la Amistad, estimada Shirley\n\nGracias por tu apoyo constante...",
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        None,
        "2026-02-13 17:06:47",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 15:37:17",
        "2026-02-13 16:56:21",
    ),
    (
        36,
        "anonimo",
        "99999999",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Giuliana Kristel Echeverría Vargas",
        "956079749",
        "comas",
        "Calle Colmena Nro. 620 - Comas (Casa).",
        "https://maps.app.goo.gl/zfMiC1eouXaK4Qz37",
        "casa",
        'Por la que despierto con una sonrisa cada día."',
        35.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:51:58",
        "2026-02-14 07:54:08",
        4,
        1,
        None,
        None,
        None,
        None,
        "2026-02-13 16:04:21",
        "2026-02-16 13:23:00",
    ),
    (
        37,
        "franz",
        "983702130",
        "2026-02-13",
        "2026-02-13",
        "tarde",
        None,
        "diana caceres mori",
        "947360101",
        "san_miguel",
        "maranga 4to etapa",
        None,
        "casa",
        "Siempre serás mi San Valentín de por vida, Te amo Esposita",
        25.00,
        "bcp",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:11:51",
        "2026-02-13 20:17:48",
        2,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 16:45:47",
        "2026-02-14 02:59:00",
    ),
    (
        38,
        "ricardo",
        "981449594",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Roxana Karyn roncal",
        "991137257",
        "santa_anita",
        "Av. Los Ruiseñores 215 santa anita",
        None,
        "casa",
        "Una linda casualidad fue testigo de un bonito amor...",
        30.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 10:44:28",
        "2026-02-14 13:48:04",
        4,
        9,
        None,
        "No está la persona que recibe, se regresará a las 15:00 horas",
        "2026-02-14 17:39:37",
        "en_ruta",
        "2026-02-13 17:07:04",
        "2026-02-16 13:30:56",
    ),
    (
        39,
        "juanga",
        "+51 912 474 371",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Nitssa Ennith de la Riva Torres",
        "983795346",
        "lima",
        "Av. Petit Thouars 455, Lima 15046",
        "https://maps.app.goo.gl/Lvmg2fpRT2oBEm89A",
        "casa",
        "Con mucho amor para la chica mas linda de todas.",
        25.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:10:36",
        "2026-02-14 02:10:40",
        4,
        8,
        None,
        "Personalmente",
        "2026-02-14 17:19:54",
        "reprogramado",
        "2026-02-13 17:47:11",
        "2026-02-14 17:19:54",
    ),
    (
        40,
        "carlos",
        "945869800",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "ludi jheni rojas",
        "945869800",
        "san_juan_miraflores",
        "calle manuel  bonilla 480",
        None,
        "casa",
        "Jheni, esposa mía:\nNo hay regalo que alcance...",
        15.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:10:51",
        "2026-02-14 02:10:58",
        2,
        7,
        None,
        "8 llamadas , mensajes de WhatsApp nunca respondió",
        "2026-02-14 13:18:00",
        "en_ruta",
        "2026-02-13 18:09:51",
        "2026-02-16 13:30:50",
    ),
    (
        41,
        "breña zorritos",
        "932191291",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "Pamela Gonzalez",
        "992898130",
        "jesus_maria",
        "Av. General Santa Cruz 673 departamento 1002 \nEdificio Green park",
        None,
        "oficina",
        "Gracias por TaDa la oportunidad que me das...",
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:59:49",
        "2026-02-13 21:02:27",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 19:07:49",
        "2026-02-14 02:58:54",
    ),
    (
        42,
        "Ernesto Laq Puente",
        "980100419",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "Carin Grandez",
        "965799632",
        "lima",
        "Jiron Loreto 290",
        None,
        "oficina",
        "Para ti mi bebé en el día del amor...",
        35.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:17:29",
        "2026-02-13 21:54:23",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 19:09:43",
        "2026-02-14 02:58:48",
    ),
    (
        43,
        "agente",
        "939621548",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "mireya cerna quiñe",
        "987387253",
        "miraflores",
        "Av. Andrés Avelino Cáceres 320, Miraflores 15047",
        None,
        "casa",
        '"Mireya, eres el latido más bonito de mi corazón."',
        15.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:06:10",
        "2026-02-13 21:02:18",
        4,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 19:18:36",
        "2026-02-14 02:58:36",
    ),
    (
        44,
        "TANIA",
        "+51 913 947 574",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "ELUTA VELZAQUES",
        "913947574",
        "santa_anita",
        "av. Los chancas de andaguaylas 109 santa anita",
        None,
        "casa",
        '"Eres la hermana que me hace sentir invincible, te quiero mucho hermanita"',
        20.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 04:26:02",
        "2026-02-14 04:26:49",
        4,
        9,
        None,
        "La dirección no estaba correcta",
        "2026-02-14 15:44:48",
        "en_ruta",
        "2026-02-13 19:30:57",
        "2026-02-14 15:44:48",
    ),
    (
        45,
        "nicolas paz",
        "932908282",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "nicolas paz",
        "932908282",
        "san_isidro",
        "Avenida Coronel Portillo 396, San Isidro",
        None,
        "casa",
        "dedicatoria vacia",
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 20:06:17",
        "2026-02-13 21:02:21",
        4,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 19:39:46",
        "2026-02-14 02:58:07",
    ),
    (
        46,
        "MICAHEL",
        "+51 935 736 037",
        "2026-02-13",
        "2026-02-13",
        "manana",
        None,
        "ZIOLA MENDOZA CALVO",
        "954776984",
        "santiago_surco",
        "Av. Paseo La Castellana 672 dpto 401",
        None,
        "casa",
        "Por más lejos que esté, tú amor siempre alimenta mis deseos...",
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-13 21:03:09",
        "2026-02-14 01:22:44",
        4,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 20:16:34",
        "2026-02-14 02:58:43",
    ),
    (
        47,
        "jhony gomesz",
        "900740395",
        "2026-02-13",
        "2026-02-13",
        "tarde",
        None,
        "daniela naramjo quispe",
        "918098992",
        "la_victoria",
        "Jr garcia naranjo nmr 1240 entre parinacocha",
        None,
        "casa",
        "PARA MI ESPOSA\nUn feliz Dia mi Princesa...",
        25.00,
        "bcp",
        "entregado",
        "listo",
        0,
        "2026-02-13 21:02:31",
        "2026-02-13 21:54:20",
        2,
        None,
        None,
        None,
        None,
        None,
        "2026-02-13 20:35:06",
        "2026-02-14 02:58:16",
    ),
    (
        48,
        "Johan Chauca",
        "943955117",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Gloria Bucheli",
        "995031814",
        "ate",
        "prolongacion los ajenjos 125 depto. 205",
        None,
        "casa",
        "TE AMO PRECIOSA\nFELIZ DIA DEL AMOR",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:07:03",
        "2026-02-14 02:07:08",
        1,
        9,
        None,
        "Recibió el señor David",
        "2026-02-14 14:36:03",
        "en_ruta",
        "2026-02-13 20:48:52",
        "2026-02-14 14:36:03",
    ),
    (
        49,
        "Renzo",
        "981541936",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "carla casella",
        "922720548",
        "san_miguel",
        "calle Manco segundo 145 dpto. 702C",
        None,
        "casa",
        "Este San Valentín quiero agradecerte por amar bonito...",
        25.00,
        "interbank",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:11:18",
        "2026-02-14 02:11:22",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 13:57:37",
        "en_ruta",
        "2026-02-13 20:55:19",
        "2026-02-14 13:57:37",
    ),
    (
        50,
        "GIAN CARLO FLORES CACERES",
        "99999999",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "beatriz matencio najarro",
        "997461467",
        "miraflores",
        "Nueva Direccion: Av, 28 de Julio 887, Torre A, Dpto 1507, Miraflores",
        None,
        "casa",
        "TE AMO, porque entendí que, aunque no te necesite para vivir...",
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:48:38",
        "2026-02-14 07:50:33",
        4,
        7,
        None,
        "Ok",
        "2026-02-14 13:05:23",
        "en_ruta",
        "2026-02-13 21:00:49",
        "2026-02-14 13:05:23",
    ),
    (
        51,
        "johan chauca",
        "943955117",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "maribel correa",
        "964657000",
        "lince",
        "Jiron Crespo y Castillo 3274, Mirones bajo",
        None,
        "casa",
        "UN DETALLE ESPECIAL para MI PERSONA ESPECIAL...",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:11:41",
        "2026-02-14 02:11:44",
        1,
        8,
        None,
        "Personalmente",
        "2026-02-14 13:46:11",
        "en_ruta",
        "2026-02-13 21:28:36",
        "2026-02-14 13:46:11",
    ),
    (
        52,
        "mathias sanchez",
        "964306164",
        "2026-02-13",
        "2026-02-14",
        "manana",
        "tocar timbre",
        "mathias sanchez",
        "964306164",
        "surquillo",
        "inca 1192 surquillo ( tocar timbre)",
        None,
        "casa",
        "Feliz día del administrador",
        15.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-13 22:03:04",
        "2026-02-13 22:03:20",
        4,
        7,
        None,
        "Todo bien",
        "2026-02-14 12:20:43",
        "en_ruta",
        "2026-02-13 21:57:36",
        "2026-02-14 12:20:43",
    ),
    (
        53,
        "quintana",
        "989208168",
        "2026-02-12",
        "2026-02-14",
        "manana",
        None,
        "Farieth Moreno",
        "989208168",
        "san_isidro",
        "Avenida Jorge Basadre Grohmann 367",
        None,
        "casa",
        "Un día más a tu lado amor...",
        15.00,
        "interbank",
        "entregado",
        "listo",
        0,
        "2026-02-14 04:12:34",
        "2026-02-14 04:15:37",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 12:37:39",
        "en_ruta",
        "2026-02-13 22:04:30",
        "2026-02-14 12:37:39",
    ),
    (
        54,
        "anonimo",
        "+51 992 369 179",
        "2026-02-13",
        "2026-02-14",
        "manana",
        "entregar de 7am a 9:30 am",
        "Aylin Neyra Miranda",
        "918257773",
        "villa_el_salvador",
        "Parque Industrial, Mz.V, Lt.11, Villa EL Salvador 15816.",
        "https://share.google/U2UXqbWbNl6Hu7M6G",
        "casa",
        '"Gracias por ser mi lugar preferido en el mundo amor de mi vida"',
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:47:53",
        "2026-02-14 09:48:32",
        4,
        10,
        None,
        ".",
        "2026-02-14 16:10:49",
        "en_ruta",
        "2026-02-13 22:08:24",
        "2026-02-14 16:10:49",
    ),
    (
        55,
        "lucero",
        "929159042",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "lucero",
        "929159042",
        "lima",
        "calle cesar vallejo 591, lima",
        None,
        "casa",
        "Feliz día",
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:47:59",
        "2026-02-14 09:48:34",
        1,
        8,
        None,
        "Rsposo",
        "2026-02-14 13:35:20",
        "en_ruta",
        "2026-02-13 22:24:24",
        "2026-02-14 13:35:20",
    ),
    (
        56,
        "johan chauca",
        "995031814",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "miryan juarez",
        "995031814",
        "jesus_maria",
        "avenida Garzon 1265",
        None,
        "casa",
        "FELIZ DIA DEL AMOR\n          ATT.\n                    G",
        11.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:51:53",
        "2026-02-14 07:54:02",
        1,
        8,
        None,
        "Personalmente",
        "2026-02-14 19:08:16",
        "reprogramado",
        "2026-02-13 22:33:51",
        "2026-02-14 19:08:16",
    ),
    (
        57,
        "newstor valdivia",
        "943546986",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "newstor valdivia",
        "943546986",
        "lima",
        "calle eugenia paredes 2337",
        None,
        "casa",
        "Feliz dia amorcito, te deseamos Enzito e Ivan",
        0.00,
        "payum",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:14:21",
        "2026-02-14 02:14:26",
        1,
        8,
        None,
        "Esposo",
        "2026-02-14 13:59:50",
        "en_ruta",
        "2026-02-13 22:49:55",
        "2026-02-14 13:59:50",
    ),
    (
        58,
        "juan carlos",
        "+51 990 034 988",
        "2026-02-13",
        "2026-02-14",
        "manana",
        "altura del colegio trilce de santa anita / casa primer piso",
        "ariana fernandez",
        "950102513",
        "santa_anita",
        "Coperativa viña san francisco manzana F lote 21 , santanita.",
        "https://www.google.com/maps/place/12%C2%B001'55.4%22S+76%C2%B057'08.8%22W/@-12.0320412,-76.9550071,17z",
        "casa",
        "Feliz san valentin , mi reyna.",
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 04:13:26",
        "2026-02-14 04:15:43",
        4,
        9,
        None,
        "Recibió la señorita Ariana",
        "2026-02-14 16:01:35",
        "en_ruta",
        "2026-02-13 23:39:26",
        "2026-02-14 16:01:35",
    ),
    (
        59,
        "anonimo",
        "+51 921 138 185",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "María del Pilar",
        "925221493",
        "santiago_surco",
        "Pasaje César Vilca Mz A lot 8 surco",
        "https://maps.app.goo.gl/Be5wSofPG24ZuMLR7?g_st=com.google.maps.preview.copy",
        "casa",
        "Así como el señor Darcy aprendió a dejar de lado el orgullo...",
        18.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:48:04",
        "2026-02-14 09:48:38",
        4,
        10,
        None,
        ".",
        "2026-02-14 16:09:35",
        "en_ruta",
        "2026-02-14 00:14:17",
        "2026-02-14 16:09:35",
    ),
    (
        60,
        "edgador zamora",
        "996486634",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "consuelo diaz cordova",
        "996481488",
        "san_borja",
        "Av. san borjas norte 412, ref ( entre la Av. las artes sur  san borjas norte",
        None,
        "oficina",
        '"Han pasado ya varios años que hemos iniciado nuestra relación..."',
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:48:07",
        "2026-02-14 09:48:42",
        2,
        10,
        None,
        ".",
        "2026-02-14 20:05:53",
        "en_ruta",
        "2026-02-14 00:27:54",
        "2026-02-14 20:05:53",
    ),
    (
        61,
        "jesus palomares grados",
        "948452016",
        "2026-02-13",
        "2026-02-14",
        "tarde",
        None,
        "andrea huaman lujan",
        "994187176",
        "santa_anita",
        "Av francisco bolognesis 1093",
        None,
        "casa",
        "En este día dedicado al amor quiero recordarte que eres mi alegría...",
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 04:14:39",
        "2026-02-14 04:15:54",
        2,
        9,
        None,
        "Recibió la misma señorita",
        "2026-02-14 15:17:48",
        "en_ruta",
        "2026-02-14 00:32:55",
        "2026-02-14 15:17:48",
    ),
    (
        62,
        "jose manuel",
        "982017029",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Sabrina Vasquez",
        "941135304",
        "ancon",
        "centrro comercial minka puerta 3 callao",
        None,
        "casa",
        None,
        30.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:48:11",
        "2026-02-14 09:48:45",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-14 00:43:09",
        "2026-02-14 17:45:56",
    ),
    (
        63,
        "marcos",
        "+51 999 972 573",
        "2026-02-13",
        "2026-02-14",
        "manana",
        "de 12 a 5pm",
        "mily sandoval",
        "+51999972573",
        "santiago_surco",
        "_Jr hernando de lavalle y pardo 140, Surco (casa)",
        None,
        "casa",
        "Te agradezco por estar a mi lado...",
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:52:07",
        "2026-02-14 07:54:11",
        4,
        10,
        None,
        ".",
        "2026-02-14 15:05:20",
        "en_ruta",
        "2026-02-14 01:29:02",
        "2026-02-14 15:05:20",
    ),
    (
        64,
        "kimen alex",
        "963835734",
        "2026-02-13",
        "2026-02-14",
        "tarde",
        None,
        "alejandra olortigue tello",
        "923044506",
        "independencia",
        "JR.celesdin 182, independecia",
        None,
        "casa",
        "nuestro futuro aquí en la tierra depende de nosotros...",
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:49:14",
        "2026-02-14 07:50:35",
        2,
        1,
        None,
        None,
        None,
        None,
        "2026-02-14 01:54:51",
        "2026-02-16 13:30:43",
    ),
    (
        65,
        "siu tong",
        "936819963",
        "2026-02-13",
        "2026-02-13",
        "tarde",
        None,
        "Roxana Gaudry",
        "936821808",
        "pueblo_libre",
        "Jiron Santiago Wagner 2569",
        None,
        "casa",
        "Feliz San Valentín amorcito! Que nuestro amor perdure siempre",
        15.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 03:08:14",
        "2026-02-14 03:08:21",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 02:00:38",
        "2026-02-14 03:08:21",
    ),
    (
        66,
        "carla",
        "+19543933252",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "luisa Herrera",
        "987861551",
        "san_miguel",
        "Avenida del pacifico 135 depto. 102",
        None,
        "casa",
        "Para mi amada esposa, Carla...",
        25.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:37:33",
        "2026-02-14 02:38:15",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 14:09:20",
        "en_ruta",
        "2026-02-14 02:20:57",
        "2026-02-14 14:09:20",
    ),
    (
        67,
        "bryan",
        "986825774",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Karla Valencia",
        "919654350",
        "pueblo_libre",
        "Cipriano dulanto 541 dpto. 203A",
        None,
        "casa",
        '"Feliz San Valentin Mi amor, espero que en este dia disfrutes todo el amor..."',
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 07:53:26",
        "2026-02-14 07:54:13",
        1,
        8,
        None,
        "Conserge",
        "2026-02-14 14:23:59",
        "en_ruta",
        "2026-02-14 02:23:37",
        "2026-02-14 14:23:59",
    ),
    (
        68,
        "alfredo Davalos",
        "983407372",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Rosemary Amesquita",
        "969373426",
        "san_martin_porres",
        "jiron German stiglich 2029",
        None,
        "casa",
        "Cuando abro mis ojos doy gracias a Dios...",
        35.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 02:35:32",
        "2026-02-14 02:35:34",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-14 02:27:47",
        "2026-02-16 13:30:38",
    ),
    (
        69,
        "jose alejandro",
        "986689732",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "Ana Maria Naseli",
        "965361624",
        "jesus_maria",
        "Avenida General Garzon 734 dpto. 401A",
        None,
        "casa",
        "FELIZ DIA DEL AMOR NAGITA, QUE SEAN MUCHOS MAS COMO FAMILIA, TE AMO !",
        20.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:48:15",
        "2026-02-14 09:48:48",
        1,
        8,
        None,
        "Personalmente",
        "2026-02-14 12:49:14",
        "en_ruta",
        "2026-02-14 02:30:05",
        "2026-02-14 12:49:14",
    ),
    (
        70,
        "mi vida eres tu",
        "953564975",
        "2026-02-13",
        "2026-02-14",
        "manana",
        None,
        "daysy Lazano",
        "943043086",
        "comas",
        "Jiron Bernardo monteagudo 204 dpto. 402",
        None,
        "casa",
        "Feliz Día de San Valentín Esposa Mía y a pesar de estar lejos de ti...",
        35.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 09:48:18",
        "2026-02-14 09:48:51",
        1,
        1,
        None,
        None,
        None,
        None,
        "2026-02-14 02:32:39",
        "2026-02-16 13:30:33",
    ),
    (
        71,
        "nat",
        "992655004",
        "2026-02-13",
        "2026-02-14",
        "manana",
        "de 12 a 5 pm / local puerta calle",
        "deysi mechan",
        "929188892",
        "lima",
        "av tacna 572",
        None,
        "casa",
        "Vi esta flor y pensé en ti, por qué eres bonita.\nSonríe",
        20.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 04:14:08",
        "2026-02-14 04:15:49",
        4,
        8,
        None,
        "Personalmente",
        "2026-02-14 18:10:26",
        "reprogramado",
        "2026-02-14 03:03:12",
        "2026-02-14 18:10:26",
    ),
    (
        72,
        "oscar",
        "942450199",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "ana caldero toro",
        "953670246",
        "miraflores",
        "calle gonzales prada 165, dpto 702 ( refenrecia campu palance )",
        None,
        "casa",
        "Feliz San Valentin, Paye!!",
        30.00,
        "bcp",
        "entregado",
        "listo",
        0,
        "2026-02-14 13:46:18",
        "2026-02-14 13:46:37",
        1,
        7,
        None,
        "Ok espera 5 minutos",
        "2026-02-14 17:10:11",
        "en_ruta",
        "2026-02-14 13:37:26",
        "2026-02-14 17:10:11",
    ),
    (
        74,
        "jose luis",
        "992254283",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "margot mendoza molina",
        "998174157",
        "la_victoria",
        "Los Jacintos 125 Urb. Balconcillos La Victoria",
        None,
        "casa",
        "Feliz San Valentín Mi Osita bella...",
        25.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 15:01:17",
        "2026-02-14 15:23:53",
        1,
        7,
        None,
        "Dirección incorrecto se entrego pedido",
        "2026-02-14 18:52:41",
        "en_ruta",
        "2026-02-14 14:52:49",
        "2026-02-14 18:52:41",
    ),
    (
        75,
        "joaquin",
        "934809674",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "alexandra montes",
        "991889884",
        "breña",
        "Admision niño de breña Avenida Brasil",
        "https://maps.google.com/maps/place//data=!4m2!3m1!1s0x9105c9002114747d:0xeadda11293cb1017",
        "oficina",
        "Feliz San Valentín Mi amor!!",
        20.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 15:01:20",
        "2026-02-14 15:05:31",
        1,
        8,
        None,
        "Personalmente",
        "2026-02-14 18:06:56",
        "en_ruta",
        "2026-02-14 15:00:29",
        "2026-02-14 18:06:56",
    ),
    (
        76,
        "ciente anonimo",
        "932988132",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "jahaira jazmin canales",
        "994238532",
        "la_victoria",
        "paseo la republica 1835/ concensionario kia AUTOLAND",
        None,
        "casa",
        "Para mi Jhaz\nFeliz San Valentín, mi amor.",
        25.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 16:08:49",
        "2026-02-14 16:09:18",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 17:29:20",
        "pendiente",
        "2026-02-14 15:54:21",
        "2026-02-14 17:29:20",
    ),
    (
        77,
        "Juan Veliz",
        "959182533",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "jonathan Barreto",
        "940440463",
        "la_victoria",
        "jiron antonio Raimondi",
        "https://www.google.com/maps/place/12%C2%B003'26.5%22S+77%C2%B000'49.4%22W",
        "casa",
        "sin dedicatoria",
        0.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 16:08:55",
        "2026-02-14 16:09:21",
        1,
        7,
        None,
        "Dirección incorrecta pero está entregado",
        "2026-02-14 18:00:18",
        "en_ruta",
        "2026-02-14 15:56:54",
        "2026-02-14 18:00:18",
    ),
    (
        78,
        "JAN VELIZ",
        "959182533",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "flor depaz",
        "936931733",
        "la_victoria",
        "jiron jauregui 523",
        None,
        "casa",
        "No existen palabras que puedan describir todo lo que siento por ti.",
        20.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 16:09:05",
        "2026-02-14 16:09:28",
        1,
        7,
        None,
        "Ok",
        "2026-02-14 18:19:08",
        "en_ruta",
        "2026-02-14 16:02:01",
        "2026-02-14 18:19:08",
    ),
    (
        79,
        "richie orozco",
        "992148873",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "betzabeth",
        "908799892",
        "santiago_surco",
        "AV AYACUCHO 920 SURCO \nEs una tienda de motos eléctricas",
        None,
        "oficina",
        "PARA LA MÁS BONITA \nMI SÚPER CHICA , MI SÚPER MAMÁ !",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-14 17:33:46",
        "2026-02-14 17:33:54",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 17:31:28",
        "2026-02-16 13:30:29",
    ),
    (
        80,
        "CD Eddi garcia",
        "951300093",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "karol genny diaz",
        "991338217",
        "san_martin_porres",
        "Av. Malecón Rímac 1996, San Martín de Porres",
        None,
        "casa",
        "Cualquier Momento A Tu Lado Es Perfecto Para Ser Feliz",
        35.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 18:12:10",
        "2026-02-14 18:12:22",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 17:50:31",
        "2026-02-16 13:30:25",
    ),
    (
        81,
        "tomas morales",
        "961826327",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "angelica maria illapama",
        "922230439",
        "lima",
        "jiron conde de las vega 996",
        None,
        "casa",
        "Eres unica  y especial Daisuki desu, feliz día de la amistad y del amor.",
        20.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 18:12:16",
        "2026-02-14 18:12:25",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 18:04:01",
        "2026-02-16 13:30:20",
    ),
    (
        83,
        "sanme",
        "953501678",
        "2026-02-14",
        "2026-02-14",
        "tarde",
        None,
        "patricia",
        "989168493",
        "la_victoria",
        "calle jose farias rios 191",
        None,
        "casa",
        "Feliz día del amor para los reinas de la casa!",
        20.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 18:45:47",
        "2026-02-14 18:51:43",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 18:18:04",
        "2026-02-16 13:30:16",
    ),
    (
        84,
        "oscar jamas  chacceri",
        "977839215",
        "2026-02-14",
        "2026-02-14",
        "tarde",
        None,
        "oscar",
        "977839215",
        "carabayllo",
        "Mz m2 lt 48 santo domingo 6ta etapa  distrito carbayllo",
        None,
        "casa",
        "feliz dia de san valentin,Gracias amor mio  por llenar mis días de risas, amor y ternura, te amo amor mio",
        40.00,
        "plin",
        "entregado",
        "listo",
        0,
        "2026-02-14 19:20:16",
        "2026-02-14 19:20:20",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:18:50",
        "2026-02-16 13:25:22",
    ),
    (
        85,
        "j torres",
        "981550874",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "yoani quispe",
        "912474481",
        "la_victoria",
        "Avenida Javier prado este 1501 dpto. 301",
        None,
        "casa",
        None,
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 19:34:57",
        "2026-02-14 19:47:02",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:19:50",
        "2026-02-16 13:25:12",
    ),
    (
        86,
        "J Torres",
        "981550874",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "elena Mamani",
        "981315123",
        "santiago_surco",
        "Jiron Trinitarias 270",
        None,
        "casa",
        None,
        20.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 19:35:02",
        "2026-02-14 19:47:10",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:21:28",
        "2026-02-16 13:24:58",
    ),
    (
        87,
        "benjamin peña",
        "966083511",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "jessi nathalie",
        "934356687",
        "los_olivos",
        "calle rio chicama 5685",
        None,
        "casa",
        None,
        30.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-14 19:35:32",
        "2026-02-14 19:47:14",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:32:15",
        "2026-02-16 13:24:43",
    ),
    (
        88,
        "dam hnt",
        "966261626",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "ingrid silvana",
        "992956355",
        "callao",
        "Mz e7 lt. 16 mi peru callao",
        None,
        "casa",
        None,
        30.00,
        "yape",
        "no_entregado",
        "listo",
        0,
        "2026-02-14 19:46:48",
        "2026-02-14 19:47:26",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:35:57",
        "2026-02-16 13:25:06",
    ),
    (
        89,
        "tania",
        "913947574",
        "2026-02-14",
        "2026-02-14",
        "manana",
        None,
        "yoisi tello",
        "979219485",
        "ate",
        "X4C6+CMH, ate",
        None,
        "casa",
        None,
        0.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-14 19:46:53",
        "2026-02-14 19:47:29",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-14 19:43:10",
        "2026-02-16 13:24:51",
    ),
    (
        90,
        "raul",
        "+17023021204",
        "2026-02-16",
        "2026-02-16",
        "manana",
        None,
        "Diana Aquino",
        "988699868",
        "lima",
        "XX3G+GH8,LIMA",
        "https://maps.google.com/?q=-12.046222,-77.023544",
        "oficina",
        "Gracias por Los momentos maravillosos que me regalas con Amor tu V.R",
        25.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-16 15:38:05",
        "2026-02-16 15:38:12",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-16 15:08:23",
        "2026-02-16 17:22:19",
    ),
    (
        91,
        "jesus",
        "943882488",
        "2026-02-16",
        "2026-02-16",
        "manana",
        None,
        "Milaqgro Obrezo",
        "943882488",
        "magdalena",
        "avenida sanchez carrion 166 dpto. 802",
        None,
        "casa",
        "km 25…y vamos por más….te amo!!!",
        20.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-16 15:38:08",
        "2026-02-16 15:41:33",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-16 15:31:32",
        "2026-02-16 16:19:53",
    ),
    (
        92,
        "dennis",
        "980446179",
        "2026-02-18",
        "2026-02-18",
        "manana",
        None,
        "nancy Gonzales",
        "987421891",
        "villa_el_salvador",
        "sector 1 grupo 17",
        "https://maps.app.goo.gl/kABaaSNbQSECX6Pr7?g_st=iw",
        "casa",
        None,
        30.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-18 15:41:36",
        "2026-02-18 16:23:49",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-18 14:44:18",
        "2026-02-18 18:41:24",
    ),
    (
        93,
        "dana ross",
        "968095082",
        "2026-02-18",
        "2026-02-20",
        "tarde",
        None,
        "dana ross",
        "968095082",
        "surquillo",
        "recoje en central",
        None,
        "oficina",
        None,
        0.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-20 17:41:58",
        "2026-02-20 18:18:43",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-18 19:44:28",
        "2026-02-21 15:10:10",
    ),
    (
        94,
        "Andrea Lozada",
        "947275559",
        "2026-02-19",
        "2026-02-21",
        "manana",
        "chocolate ferrero roche y 1 globo de feliz cumpleaños",
        "Andrea Lozada",
        "974275559",
        "san_juan_lurigancho",
        "Jiron las Grosellas 1030",
        None,
        "casa",
        '"Feliz cumpleaños, Martitha."',
        30.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-21 15:05:30",
        "2026-02-21 15:40:37",
        1,
        11,
        None,
        None,
        None,
        None,
        "2026-02-19 14:50:35",
        "2026-02-21 15:40:37",
    ),
    (
        95,
        "fghjjv",
        "941260085",
        "2026-02-20",
        "2026-02-20",
        "manana",
        None,
        "laura moscol",
        "979818786",
        "san_isidro",
        "Juan de Arona 151",
        None,
        "casa",
        None,
        10.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-20 17:41:50",
        "2026-02-20 18:18:49",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-20 13:28:09",
        "2026-02-20 18:18:59",
    ),
    (
        96,
        "johan chauca",
        "943955117",
        "2026-02-20",
        "2026-02-22",
        "manana",
        None,
        "Raisa Correa",
        "999220202",
        "san_miguel",
        "Jiron Mariscal Ramos Castilla 520 dpto. A202.",
        None,
        "casa",
        None,
        25.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-21 16:27:02",
        "2026-02-21 21:31:50",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-20 20:38:31",
        "2026-02-23 16:27:15",
    ),
    (
        97,
        "Juan Mayo",
        "+34637193919",
        "2026-02-21",
        "2026-02-21",
        "tarde",
        None,
        "akeemy mayo Marchena",
        "+51969501863",
        "la_victoria",
        "Galeria Gama\nsemisotano\n041 Gamarra la Victoria",
        None,
        "oficina",
        None,
        21.00,
        "izipay",
        "entregado",
        "listo",
        0,
        "2026-02-21 19:28:06",
        "2026-02-21 21:26:40",
        1,
        11,
        None,
        None,
        None,
        None,
        "2026-02-21 19:18:44",
        "2026-02-21 23:37:03",
    ),
    (
        98,
        "Luis Angel",
        "996006943",
        "2026-02-21",
        "2026-02-21",
        "tarde",
        None,
        "Kiara Vela",
        "990997889",
        "san_borja",
        "Fray Angelico 279.",
        None,
        "casa",
        None,
        18.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-21 21:26:42",
        "2026-02-21 23:37:10",
        1,
        11,
        None,
        None,
        None,
        None,
        "2026-02-21 20:21:35",
        "2026-02-21 23:37:10",
    ),
    (
        99,
        "edwin",
        "990336012",
        "2026-02-20",
        "2026-02-23",
        "manana",
        None,
        "NADIESKA DEIDAMIA GOICOCHEA JALCA",
        "991766895",
        "miraflores",
        "Sede Central MINJUSDH: Calle Scipión Llona N° 350, Miraflores, Lima.",
        None,
        "oficina",
        "rosas color lila, rosadas, amrillas, fucsias, blancas",
        15.00,
        "bcp",
        "entregado",
        "listo",
        0,
        "2026-02-21 21:31:57",
        "2026-02-23 16:27:00",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-21 21:30:43",
        "2026-02-23 16:27:08",
    ),
    (
        100,
        "rossana ciccia",
        "994226352",
        "2026-02-23",
        "2026-02-24",
        "manana",
        None,
        "Ita Ridella",
        "013724020",
        "san_borja",
        "Avenida del Pinar 412, Chacarilla del Estanque",
        None,
        "casa",
        None,
        15.00,
        "yape",
        "entregado",
        "listo",
        0,
        "2026-02-23 19:41:34",
        "2026-02-23 20:15:01",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-23 19:41:03",
        "2026-02-24 17:11:15",
    ),
    (
        101,
        "ej de rita",
        "+34681262397",
        "2026-02-24",
        "2026-02-24",
        "manana",
        "peluche de perrito pequeño",
        "Katheryn Hidalgo",
        "98059706",
        "ate",
        "Avenida los ingenieros  Mz. E, Lt. 11",
        None,
        "oficina",
        None,
        40.00,
        "efectivo",
        "entregado",
        "listo",
        0,
        "2026-02-24 17:10:47",
        "2026-02-24 17:10:53",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-24 16:57:43",
        "2026-02-24 17:45:50",
    ),
    (
        102,
        "diego TMM",
        "961499562",
        "2026-02-24",
        "2026-02-25",
        "manana",
        "rosas rosadas",
        "Solangel Carvajal",
        "975311917",
        "san_isidro",
        "Calle 1 Oeste 061",
        None,
        "casa",
        None,
        24.00,
        "izipay",
        "pendiente",
        "listo",
        0,
        "2026-02-25 13:45:16",
        "2026-02-25 13:45:20",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-24 16:59:39",
        "2026-02-25 13:45:20",
    ),
    (
        103,
        "karin quijada",
        "937009402",
        "2026-02-24",
        "2026-02-24",
        "tarde",
        None,
        "karin quijada",
        "937009402",
        "jesus_maria",
        "Avenida Garzon 87 dept. 201",
        None,
        "casa",
        None,
        3.00,
        "izipay",
        "en_ruta",
        "listo",
        0,
        "2026-02-24 17:10:50",
        "2026-02-24 21:05:14",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-24 17:08:32",
        "2026-02-24 21:06:09",
    ),
    (
        104,
        "tori",
        "976564025",
        "2026-02-24",
        "2026-02-24",
        "manana",
        None,
        "rosa torres de nContreras",
        "952664483",
        "san_juan_lurigancho",
        "Jiron los Medicos 3753",
        None,
        "casa",
        None,
        30.00,
        "izipay",
        "pendiente",
        "listo",
        0,
        "2026-02-24 21:05:17",
        "2026-02-24 21:05:20",
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-24 19:57:18",
        "2026-02-24 21:05:20",
    ),
    (
        105,
        "Aaron",
        "998809922",
        "2026-02-24",
        "2026-02-25",
        "tarde",
        None,
        "Maria Echegoyen",
        "941573341",
        "lima",
        "Jiron zorritos 1203 (Puerta Principal del MTC)",
        None,
        "oficina",
        None,
        20.00,
        "yape",
        "pendiente",
        "pendiente",
        0,
        None,
        None,
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-25 13:42:37",
        "2026-02-25 13:45:11",
    ),
    (
        106,
        "cristian palomino",
        "988653793",
        "2026-02-24",
        "2026-02-28",
        "manana",
        None,
        "cristian palomino",
        "988653793",
        "san_isidro",
        "Calle Juan Norberto Elespurru 535 dpto. 1205",
        None,
        "casa",
        None,
        25.00,
        "izipay",
        "pendiente",
        "pendiente",
        0,
        None,
        None,
        1,
        None,
        None,
        None,
        None,
        None,
        "2026-02-25 13:44:54",
        "2026-02-25 13:44:54",
    ),
]

# item_reportes completo del dump
ITEM_REPORTES = [
    # (id, reporte_id, producto_id, cantidad, precio_unitario, created_at)
    (5, 5, 2, 1, 260.00, "2026-02-09 16:09:45"),
    (9, 7, 6, 1, 129.00, "2026-02-09 22:20:31"),
    (10, 7, 16, 1, 165.00, "2026-02-09 22:20:31"),
    (12, 9, 13, 1, 279.00, "2026-02-10 19:35:14"),
    (13, 10, 6, 1, 129.00, "2026-02-10 20:15:06"),
    (14, 11, 13, 1, 279.00, "2026-02-11 17:51:57"),
    (16, 13, 2, 1, 260.00, "2026-02-11 18:32:56"),
    (18, 15, 13, 1, 279.00, "2026-02-11 23:43:59"),
    (19, 15, 20, 1, 36.00, "2026-02-11 23:43:59"),
    (20, 15, 19, 1, 36.00, "2026-02-11 23:43:59"),
    (21, 16, 16, 1, 165.00, "2026-02-11 23:54:03"),
    (22, 17, 1, 1, 299.00, "2026-02-12 00:49:30"),
    (23, 18, 6, 1, 129.00, "2026-02-12 15:59:46"),
    (25, 19, 16, 1, 165.00, "2026-02-12 17:25:32"),
    (26, 20, 17, 1, 305.00, "2026-02-12 20:19:59"),
    (28, 4, 9, 1, 229.00, "2026-02-12 20:53:05"),
    (29, 22, 16, 1, 165.00, "2026-02-12 21:17:36"),
    (30, 22, 22, 1, 119.00, "2026-02-12 21:17:36"),
    (34, 23, 12, 1, 169.00, "2026-02-12 22:10:06"),
    (36, 25, 17, 1, 305.00, "2026-02-13 00:34:24"),
    (38, 27, 4, 1, 299.00, "2026-02-13 01:31:01"),
    (41, 29, 6, 1, 129.00, "2026-02-13 02:32:43"),
    (46, 32, 6, 1, 129.00, "2026-02-13 14:04:13"),
    (47, 30, 19, 1, 36.00, "2026-02-13 14:10:46"),
    (48, 30, 22, 1, 119.00, "2026-02-13 14:10:46"),
    (49, 26, 23, 1, 199.00, "2026-02-13 14:11:30"),
    (50, 21, 4, 1, 299.00, "2026-02-13 14:11:44"),
    (51, 14, 14, 1, 199.00, "2026-02-13 14:11:57"),
    (52, 12, 6, 1, 129.00, "2026-02-13 14:12:13"),
    (53, 8, 15, 1, 199.00, "2026-02-13 14:12:29"),
    (54, 3, 2, 1, 260.00, "2026-02-13 14:13:02"),
    (55, 33, 18, 1, 169.00, "2026-02-13 15:25:29"),
    (56, 34, 7, 1, 169.00, "2026-02-13 15:29:13"),
    (57, 35, 14, 1, 199.00, "2026-02-13 15:37:17"),
    (58, 36, 10, 1, 199.00, "2026-02-13 16:04:21"),
    (59, 37, 13, 1, 279.00, "2026-02-13 16:45:48"),
    (60, 39, 16, 1, 165.00, "2026-02-13 17:47:11"),
    (61, 28, 16, 1, 165.00, "2026-02-13 17:59:20"),
    (64, 42, 6, 1, 129.00, "2026-02-13 19:09:43"),
    (65, 42, 19, 1, 36.00, "2026-02-13 19:09:43"),
    (66, 43, 16, 1, 165.00, "2026-02-13 19:18:36"),
    (67, 41, 15, 1, 199.00, "2026-02-13 19:18:56"),
    (71, 45, 4, 1, 299.00, "2026-02-13 19:56:10"),
    (72, 46, 1, 1, 299.00, "2026-02-13 20:16:35"),
    (73, 47, 7, 1, 169.00, "2026-02-13 20:35:07"),
    (74, 48, 3, 1, 329.00, "2026-02-13 20:48:52"),
    (75, 49, 16, 1, 165.00, "2026-02-13 20:55:19"),
    (81, 51, 16, 1, 165.00, "2026-02-13 21:28:36"),
    (83, 53, 16, 1, 165.00, "2026-02-13 22:04:30"),
    (90, 54, 7, 1, 169.00, "2026-02-13 22:10:11"),
    (91, 54, 24, 1, 30.00, "2026-02-13 22:10:11"),
    (92, 55, 18, 1, 169.00, "2026-02-13 22:24:24"),
    (93, 55, 16, 1, 165.00, "2026-02-13 22:24:24"),
    (94, 55, 23, 1, 199.00, "2026-02-13 22:24:24"),
    (95, 56, 10, 1, 199.00, "2026-02-13 22:33:51"),
    (96, 6, 6, 1, 129.00, "2026-02-13 22:39:01"),
    (97, 57, 13, 1, 279.00, "2026-02-13 22:49:55"),
    (98, 52, 17, 1, 305.00, "2026-02-13 22:56:36"),
    (99, 44, 18, 1, 169.00, "2026-02-13 23:09:39"),
    (101, 58, 16, 1, 165.00, "2026-02-13 23:39:40"),
    (106, 50, 6, 1, 129.00, "2026-02-13 23:48:18"),
    (107, 50, 19, 1, 36.00, "2026-02-13 23:48:18"),
    (109, 59, 14, 1, 199.00, "2026-02-14 00:15:55"),
    (115, 60, 5, 1, 299.00, "2026-02-14 00:36:32"),
    (116, 61, 16, 1, 165.00, "2026-02-14 00:37:04"),
    (117, 62, 4, 1, 299.00, "2026-02-14 00:43:09"),
    (118, 62, 9, 1, 229.00, "2026-02-14 00:43:09"),
    (120, 63, 10, 1, 199.00, "2026-02-14 01:29:31"),
    (121, 64, 24, 1, 30.00, "2026-02-14 01:54:51"),
    (122, 64, 6, 1, 129.00, "2026-02-14 01:54:51"),
    (123, 64, 19, 1, 36.00, "2026-02-14 01:54:51"),
    (125, 65, 16, 1, 165.00, "2026-02-14 02:01:43"),
    (129, 69, 7, 1, 169.00, "2026-02-14 02:30:05"),
    (130, 70, 15, 1, 199.00, "2026-02-14 02:32:40"),
    (131, 66, 1, 1, 299.00, "2026-02-14 02:34:26"),
    (132, 67, 11, 1, 169.00, "2026-02-14 02:46:53"),
    (134, 68, 3, 1, 329.00, "2026-02-14 02:52:22"),
    (135, 71, 16, 1, 165.00, "2026-02-14 03:03:12"),
    (137, 38, 2, 1, 260.00, "2026-02-14 12:11:31"),
    (138, 72, 16, 1, 165.00, "2026-02-14 13:37:26"),
    (141, 74, 22, 1, 119.00, "2026-02-14 14:52:49"),
    (142, 75, 6, 1, 129.00, "2026-02-14 15:00:29"),
    (144, 77, 6, 1, 129.00, "2026-02-14 15:56:54"),
    (145, 78, 22, 1, 119.00, "2026-02-14 16:02:01"),
    (146, 76, 6, 1, 129.00, "2026-02-14 16:10:46"),
    (147, 40, 16, 1, 165.00, "2026-02-14 16:39:33"),
    (148, 79, 6, 1, 129.00, "2026-02-14 17:31:29"),
    (149, 80, 6, 1, 129.00, "2026-02-14 17:50:31"),
    (150, 81, 16, 1, 165.00, "2026-02-14 18:04:01"),
    (151, 83, 2, 1, 260.00, "2026-02-14 18:18:04"),
    (152, 84, 9, 1, 229.00, "2026-02-14 19:18:50"),
    (153, 85, 16, 1, 165.00, "2026-02-14 19:19:50"),
    (154, 86, 7, 1, 169.00, "2026-02-14 19:21:28"),
    (155, 87, 13, 1, 279.00, "2026-02-14 19:32:15"),
    (156, 89, 18, 1, 169.00, "2026-02-14 19:43:10"),
    (157, 88, 16, 1, 165.00, "2026-02-14 19:46:36"),
    (161, 92, 16, 1, 165.00, "2026-02-18 15:47:43"),
    (162, 91, 6, 1, 129.00, "2026-02-18 15:47:59"),
    (163, 90, 6, 1, 129.00, "2026-02-18 15:48:14"),
    (164, 93, 25, 1, 170.00, "2026-02-18 19:44:29"),
    (165, 94, 26, 1, 269.00, "2026-02-19 14:50:36"),
    (166, 95, 27, 1, 217.00, "2026-02-20 13:28:10"),
    (167, 96, 28, 1, 185.00, "2026-02-20 20:38:31"),
    (168, 97, 30, 1, 125.00, "2026-02-21 19:18:44"),
    (169, 97, 29, 1, 199.00, "2026-02-21 19:18:44"),
    (170, 98, 31, 1, 70.00, "2026-02-21 20:21:35"),
    (176, 99, 32, 1, 213.92, "2026-02-21 23:46:21"),
    (177, 100, 11, 1, 109.00, "2026-02-23 19:41:04"),
    (178, 100, 19, 1, 36.00, "2026-02-23 19:41:04"),
    (179, 101, 24, 1, 30.00, "2026-02-24 16:57:43"),
    (181, 102, 31, 1, 70.00, "2026-02-24 16:59:59"),
    (185, 103, 11, 1, 109.00, "2026-02-24 17:10:27"),
    (186, 103, 33, 1, 60.00, "2026-02-24 17:10:27"),
    (187, 104, 34, 1, 199.00, "2026-02-24 19:57:18"),
    (189, 106, 28, 1, 185.00, "2026-02-25 13:44:54"),
    (190, 105, 35, 1, 49.00, "2026-02-25 13:45:11"),
]


def parse_ts(ts_str):
    if ts_str is None:
        return None
    dt = datetime.strptime(ts_str, "%Y-%m-%d %H:%M:%S")
    return dt.replace(tzinfo=timezone.utc)


def parse_date(date_str):
    if not date_str:
        return None
    return datetime.strptime(date_str, "%Y-%m-%d").date()


def normalize_phone(phone):
    p = str(phone).replace(" ", "").replace("-", "").replace("(", "").replace(")", "")
    if p.startswith("+51"):
        p = p[3:]
    elif p.startswith("+"):
        p = p[1:]
    return p[:20]


def gen_codigo(length=8):
    return "".join(random.choices(string.ascii_uppercase + string.digits, k=length))


def map_metodo_pago(mp):
    MAP = {
        "efectivo": "efectivo",
        "yape": "yape_plin",
        "plin": "yape_plin",
        "izipay": "tarjeta",
        "bcp": "transferencia",
        "interbank": "transferencia",
        "payum": "transferencia",
    }
    return MAP.get(mp, "efectivo")


def map_estado_pedido(estado, estado_anterior):
    MAP = {
        "pendiente": "pendiente",
        "en_ruta": "en_ruta",
        "entregado": "entregado",
        "no_entregado": "cancelado",
        "reprogramado": "pendiente",
    }
    return MAP.get(estado, "pendiente")


def map_estado_produccion(ep):
    if ep == "listo":
        return "completado"
    return "pendiente"


def build_notas(distrito, tipo_ubicacion, observacion, estado, estado_anterior):
    """Concatenar distrito y tipo_ubicacion al inicio de notas."""
    parts = []
    if distrito:
        parts.append(f"Distrito: {distrito}")
    if tipo_ubicacion:
        parts.append(f"Tipo: {tipo_ubicacion}")
    if estado == "reprogramado":
        parts.append("Estado anterior: reprogramado")
    if estado_anterior:
        parts.append(f"Estado anterior: {estado_anterior}")
    if observacion:
        parts.append(observacion)
    return " | ".join(parts)


def get_lookups(cur):
    """Obtener todos los mappings necesarios desde la DB."""
    # user_email → perfil_id
    cur.execute(
        "SELECT u.email, pu.id FROM perfiles_usuario pu JOIN usuarios u ON u.id = pu.usuario_id"
    )
    email_to_perfil = {row[0]: str(row[1]) for row in cur.fetchall()}

    # perfil mysql_id no lo tenemos directamente, usamos email
    # Mapeamos los emails conocidos a mysql user_id
    EMAIL_BY_MYSQLID = {
        1: "amatista@gmail.com",
        2: "delevery@detallesamatista.com",
        3: "detallesamatista01@gmail.com",
        4: "detallesamatista86@gmail.com",
        5: "tsaune@icloud.com",
    }
    mysql_user_to_perfil = {}
    for mysql_id, email in EMAIL_BY_MYSQLID.items():
        if email in email_to_perfil:
            mysql_user_to_perfil[mysql_id] = email_to_perfil[email]

    # transportista token → uuid
    cur.execute("SELECT token, id FROM transportistas")
    # Necesitamos mapear conductor_id mysql a transportista uuid
    # Los tokens son UUIDs directos del dump, pero necesitamos mysql_id → transportista_uuid
    # Usamos nombre para correlacionar
    cur.execute("SELECT nombre, id FROM transportistas")
    nombre_to_trans = {row[0]: str(row[1]) for row in cur.fetchall()}

    CONDUCTOR_NOMBRE = {
        1: "Alejandro Canales",
        2: "Cesar rivas",
        3: "Christian Alexander",
        4: "Johan",
        5: "joshymar saune",
        6: "Rafael Varela (MOTO)",
        7: "Yesenia Aguirre",
        8: "Juan Carlos Tafur",
        9: "Luis Enrique",
        10: "fiorella sanchez",
        11: "jose luis",
    }
    mysql_conductor_to_trans = {}
    for mysql_id, nombre in CONDUCTOR_NOMBRE.items():
        if nombre in nombre_to_trans:
            mysql_conductor_to_trans[mysql_id] = nombre_to_trans[nombre]

    # telefono_normalizado → cliente_uuid
    cur.execute("SELECT telefono, id FROM clientes")
    phone_to_cliente = {row[0]: str(row[1]) for row in cur.fetchall()}

    # sku → producto_uuid
    cur.execute("SELECT sku, id FROM productos")
    sku_to_producto = {row[0]: str(row[1]) for row in cur.fetchall()}
    # mysql_prod_id → uuid via PROD-{id:03d}
    mysql_prod_to_uuid = {}
    for mysql_id in range(1, 36):
        sku = f"PROD-{mysql_id:03d}"
        if sku in sku_to_producto:
            mysql_prod_to_uuid[mysql_id] = sku_to_producto[sku]

    return (
        mysql_user_to_perfil,
        mysql_conductor_to_trans,
        phone_to_cliente,
        mysql_prod_to_uuid,
    )


def main():
    conn = psycopg2.connect(**DB_CONFIG)
    conn.autocommit = False
    cur = conn.cursor()

    print("=" * 60)
    print("MIGRACIÓN PARTE 3: ventas, pedidos, detalle_ventas")
    print("=" * 60)

    # Obtener lookups
    (
        mysql_user_to_perfil,
        mysql_conductor_to_trans,
        phone_to_cliente,
        mysql_prod_to_uuid,
    ) = get_lookups(cur)

    # Admin perfil como fallback para vendedor_id (si no se encuentra el vendedor real)
    admin_perfil_id = mysql_user_to_perfil.get(1)
    if not admin_perfil_id:
        print("ERROR: No se encontró perfil del administrador.")
        conn.close()
        return

    # ── PASO 10: Calcular totales por reporte (suma de items) ─────
    # Agrupar item_reportes por reporte_id
    items_by_reporte = {}
    for item_id, reporte_id, prod_id, cantidad, precio_u, created_at in ITEM_REPORTES:
        if reporte_id not in items_by_reporte:
            items_by_reporte[reporte_id] = []
        items_by_reporte[reporte_id].append((prod_id, cantidad, precio_u, created_at))

    # ── PASO 11: Crear ventas y pedidos ───────────────────────────
    print("\n[10+11] Creando ventas y pedidos...")
    reporte_to_venta_uuid = {}  # reporte mysql_id → venta uuid
    reporte_to_pedido_uuid = {}
    codigos_usados = set()

    for reporte in REPORTE_ENTREGAS:
        (
            r_id,
            nombre_cliente,
            telefono_cliente,
            fecha_compra,
            fecha_entrega,
            turno_entrega,
            observacion,
            nombre_dest,
            telefono_dest,
            distrito,
            direccion_dest,
            enlace_ubicacion,
            tipo_ubicacion,
            dedicatoria,
            costo_delivery,
            metodo_pago,
            estado,
            estado_produccion,
            es_urgente,
            prod_iniciada_en,
            prod_completada_en,
            created_by,
            conductor_id,
            foto_entrega,
            obs_conductor,
            fecha_confirmacion,
            estado_anterior,
            created_at,
            updated_at,
        ) = reporte

        # Lookups
        tel_norm = normalize_phone(telefono_cliente)
        cliente_uuid = phone_to_cliente.get(tel_norm)

        # Si el cliente no existe, crearlo al vuelo
        if not cliente_uuid:
            cliente_uuid = str(uuid.uuid4())
            doc_num = f"{abs(hash(tel_norm)) % 90000000 + 10000000}"
            cur.execute(
                """
                INSERT INTO clientes (
                    id, tipo_documento, numero_documento,
                    razon_social, nombre_comercial,
                    telefono, email, direccion, ubigeo,
                    segmento, limite_credito, is_active,
                    creado_por_id, actualizado_por_id,
                    created_at, updated_at
                ) VALUES (%s, '0', %s, %s, %s, %s, '', '', '', 'nuevo', 0, TRUE, %s, NULL, NOW(), NOW())
            """,
                (
                    cliente_uuid,
                    doc_num,
                    nombre_cliente[:200],
                    nombre_cliente[:200],
                    tel_norm[:20],
                    admin_perfil_id,
                ),
            )
            phone_to_cliente[tel_norm] = cliente_uuid
            print(f"   + Cliente creado al vuelo: '{nombre_cliente}' tel={tel_norm}")

        vendedor_uuid = mysql_user_to_perfil.get(created_by, admin_perfil_id)
        transportista_uuid = (
            mysql_conductor_to_trans.get(conductor_id) if conductor_id else None
        )

        # Calcular total_venta
        items = items_by_reporte.get(r_id, [])
        total_items = sum(float(cant) * float(precio) for (_, cant, precio, _) in items)
        total_venta = total_items + float(costo_delivery)
        # IGV: precio incluye IGV → igv = total - total/1.18
        total_igv = round(total_venta - total_venta / 1.18, 4)
        total_gravada = round(total_venta - total_igv, 4)

        # Fechas
        fecha_compra_d = parse_date(fecha_compra)
        fecha_entrega_d = parse_date(fecha_entrega)
        prod_ini_dt = parse_ts(prod_iniciada_en)
        prod_comp_dt = parse_ts(prod_completada_en)
        fecha_conf_dt = parse_ts(fecha_confirmacion)
        created_at_dt = parse_ts(created_at)
        updated_at_dt = parse_ts(updated_at)

        # Mapeos
        metodo_pago_erp = map_metodo_pago(metodo_pago)
        estado_pedido_erp = map_estado_pedido(estado, estado_anterior)
        estado_prod_erp = map_estado_produccion(estado_produccion)

        # Notas
        notas = build_notas(
            distrito, tipo_ubicacion, observacion, estado, estado_anterior
        )

        # ── Crear VENTA ──────────────────────────────────────────
        venta_uuid = str(uuid.uuid4())
        reporte_to_venta_uuid[r_id] = venta_uuid
        numero_venta = f"MIGR-{r_id:03d}"

        cur.execute(
            """
            INSERT INTO ventas (
                id, numero, fecha,
                cliente_id, vendedor_id,
                tipo_venta, metodo_pago,
                total_gravada, total_igv, total_descuento, total_venta,
                estado, is_active,
                creado_por_id,
                created_at, updated_at
            ) VALUES (
                %s, %s, %s,
                %s, %s,
                'online', %s,
                %s, %s, 0, %s,
                'completada', TRUE,
                %s,
                %s, %s
            )
        """,
            (
                venta_uuid,
                numero_venta,
                fecha_compra_d,
                cliente_uuid,
                vendedor_uuid,
                metodo_pago_erp,
                total_gravada,
                total_igv,
                total_venta,
                vendedor_uuid,
                created_at_dt,
                updated_at_dt,
            ),
        )

        # ── Crear PEDIDO ─────────────────────────────────────────
        pedido_uuid = str(uuid.uuid4())
        reporte_to_pedido_uuid[r_id] = pedido_uuid
        numero_pedido = f"PED-{r_id:03d}"

        # Código de seguimiento único de 8 chars
        codigo = gen_codigo(8)
        while codigo in codigos_usados:
            codigo = gen_codigo(8)
        codigos_usados.add(codigo)

        # Enlace ubicacion: usar vacío si None (campo NOT NULL en modelo)
        enlace = enlace_ubicacion or ""
        # Truncar a 2000 chars por seguridad
        enlace = enlace[:2000]

        # dedicatoria: '' si None
        dedicatoria_v = dedicatoria or ""
        # obs_conductor: '' si None
        obs_cond_v = obs_conductor or ""
        # turno: normalizar a 10 chars
        turno_v = (turno_entrega or "manana")[:10]

        cur.execute(
            """
            INSERT INTO pedidos (
                id, numero, fecha, venta_id, cliente_id,
                direccion_entrega, enlace_ubicacion,
                nombre_destinatario, telefono_destinatario,
                estado, transportista_id,
                fecha_estimada_entrega, fecha_pedido,
                turno_entrega, turno_express_rango,
                notas, dedicatoria,
                costo_delivery, es_urgente,
                estado_produccion,
                produccion_iniciada_en, produccion_completada_en,
                fecha_confirmacion, foto_entrega,
                observacion_conductor,
                codigo_seguimiento,
                prioridad, is_active,
                creado_por_id,
                created_at, updated_at
            ) VALUES (
                %s, %s, %s, %s, %s,
                %s, %s,
                %s, %s,
                %s, %s,
                %s, %s,
                %s, '',
                %s, %s,
                %s, %s,
                %s,
                %s, %s,
                %s, %s,
                %s,
                %s,
                'normal', TRUE,
                %s,
                %s, %s
            )
        """,
            (
                pedido_uuid,
                numero_pedido,
                fecha_compra_d,
                venta_uuid,
                cliente_uuid,
                direccion_dest or "",
                enlace,
                (nombre_dest or "")[:200],
                normalize_phone(telefono_dest)[:20],
                estado_pedido_erp,
                transportista_uuid,
                fecha_entrega_d,
                fecha_compra_d,
                turno_v,
                notas,
                dedicatoria_v,
                float(costo_delivery),
                bool(es_urgente),
                estado_prod_erp,
                prod_ini_dt,
                prod_comp_dt,
                fecha_conf_dt,
                foto_entrega,
                obs_cond_v,
                codigo,
                vendedor_uuid,
                created_at_dt,
                updated_at_dt,
            ),
        )

    print(f"   ✓ {len(REPORTE_ENTREGAS)} ventas creadas")
    print(f"   ✓ {len(REPORTE_ENTREGAS)} pedidos creados")

    # ── PASO 12: Migrar item_reportes → detalle_ventas ────────────
    print("\n[12] Migrando detalle de ventas...")
    detalles_ok = 0
    detalles_skip = 0

    for (
        item_id,
        reporte_id,
        prod_mysql_id,
        cantidad,
        precio_u,
        created_at_str,
    ) in ITEM_REPORTES:
        venta_uuid = reporte_to_venta_uuid.get(reporte_id)
        prod_uuid = mysql_prod_to_uuid.get(prod_mysql_id)

        if not venta_uuid:
            print(
                f"   ⚠ item {item_id}: reporte_id {reporte_id} no encontrado en ventas, SKIP"
            )
            detalles_skip += 1
            continue
        if not prod_uuid:
            print(
                f"   ⚠ item {item_id}: producto_id {prod_mysql_id} no encontrado, SKIP"
            )
            detalles_skip += 1
            continue

        cant = float(cantidad)
        precio = float(precio_u)
        subtotal = cant * precio
        igv = round(subtotal - subtotal / 1.18, 4)
        total = round(subtotal, 4)
        created_at_dt = parse_ts(created_at_str)
        dv_id = str(uuid.uuid4())

        cur.execute(
            """
            INSERT INTO detalle_ventas (
                id, venta_id, producto_id,
                cantidad, precio_unitario, descuento_porcentaje,
                subtotal, igv, total,
                estado_produccion, produccion_completada_en, produccion_iniciada_en,
                created_at, updated_at
            ) VALUES (
                %s, %s, %s,
                %s, %s, 0,
                %s, %s, %s,
                'completado', NULL, NULL,
                %s, %s
            )
        """,
            (
                dv_id,
                venta_uuid,
                prod_uuid,
                cant,
                precio,
                subtotal,
                igv,
                total,
                created_at_dt,
                created_at_dt,
            ),
        )
        detalles_ok += 1

    print(f"   ✓ {detalles_ok} detalles migrados, {detalles_skip} omitidos")

    conn.commit()
    print("\n✅ PARTE 3 completada exitosamente.")
    print(f"   Ventas: {len(REPORTE_ENTREGAS)}")
    print(f"   Pedidos: {len(REPORTE_ENTREGAS)}")
    print(f"   Detalles: {detalles_ok}")

    cur.close()
    conn.close()


if __name__ == "__main__":
    main()
